schemaVersion: 3
meta:
  sourceVersionId: 7435ca90-d974-48b4-919b-dd5b825cd7a4 # DO NOT CHANGE - Hex uses this to match up project versions when reimporting the file
  description: null
  projectId: 4b26f8c2-b133-47e5-b739-8ea75e22e09a # DO NOT CHANGE - Unique ID of the project from which this file was generated
  title: "[PROV SERV] MSRs"
  timezone: null
  appTheme: SYS_PREF
  codeLanguage: PYTHON
  status: null
  categories: []
  castDecimalsDefault: true
  logicQueryCacheTimeout: null
  publishedQueryCacheTimeout: null
projectAssets:
  dataConnections: []
  envVars: []
  secrets: []
sharedAssets:
  secrets: []
  vcsPackages: []
  dataConnections:
    - dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030 # prod-mapa-org (postgres)
  externalFileIntegrations: []
cells:
  - cellType: MARKDOWN
    cellId: a321b720-6994-440d-8a99-8284253733b5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: MSRs cadastradas
    config:
      source: |-
        # MSRs cadastradas
        MSRs que se cadastraram no Mapa e realizaram um pedido de acolhimento válido. MSRs fora do perfil ou sem tickets no Zendesk não estão contabilizadas. A data de cadastro considerada é a data de abertura do pedido de acolhimento.
  - cellType: BLOCK
    cellId: ae3924f2-3eb9-4c61-9d32-c8700a225565 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 0d81bcd1-5686-49c3-bea5-56215e32c5c5
        chartCellId: a6e89fa5-15ef-496f-b2f8-e1fac76eafb1
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 0d81bcd1-5686-49c3-bea5-56215e32c5c5
          cellLabel: total
          config:
            source: |-
              WITH distinct_msr AS (
                  SELECT 
                      msr_id,
                      MIN(created_at) AS created_at
                  FROM match.support_requests
                  GROUP BY msr_id
              ),
              msr_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(msr_id) AS msr_per_year
                  FROM distinct_msr    GROUP BY 1
              )
              SELECT
                  *,
                  SUM(msr_per_year) OVER(ORDER BY year)::INT AS cumulative_msr_count
              FROM msr_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: msrs_cadastradas_total
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: a6e89fa5-15ef-496f-b2f8-e1fac76eafb1
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: area
                      axis:
                        type: number
                        style:
                          max: 20000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "     "
                        aggregate: sum
                      dataFrameColumns:
                        - cumulative_msr_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#451952"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: above-left
                      line: true
                      point: true
                      normalize: false
                  dataFrame: msrs_cadastradas_total
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 08ebd385-c8c5-4d65-ab8e-a464c753d194 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 8e562d19-a572-4175-ae6b-9c2cd8665ddf
        chartCellId: 3aa479a8-957f-428a-9e47-5b97ac7497de
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 8e562d19-a572-4175-ae6b-9c2cd8665ddf
          cellLabel: por ano
          config:
            source: |-
              WITH distinct_msr AS (
                  SELECT 
                      msr_id,
                      MIN(created_at) AS created_at
                  FROM match.support_requests
                  GROUP BY msr_id
              ),
              msr_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(msr_id) AS msr_per_year
                  FROM distinct_msr    GROUP BY 1
              )
              SELECT
                  *,
                  SUM(msr_per_year) OVER(ORDER BY year)::INT AS cumulative_msr_count
              FROM msr_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: msrs_cadastradas_por_ano
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 3aa479a8-957f-428a-9e47-5b97ac7497de
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 6000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "      "
                        aggregate: sum
                      dataFrameColumns:
                        - msr_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#451952"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                  dataFrame: msrs_cadastradas_por_ano
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_6
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 662b7274-353e-4a30-a2d6-f8c1d5210884 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: aa413244-21e7-4eee-bd3e-15c02671c263
        chartCellId: 1889345f-016e-4b2c-80de-fb1636b8fa13
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: aa413244-21e7-4eee-bd3e-15c02671c263
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH distinct_msr AS (
                  SELECT 
                      msr_id,
                      MIN(created_at) AS created_at
                  FROM match.support_requests
                  GROUP BY msr_id
              ),
              msr_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      COUNT(DISTINCT msr_id) AS msr_per_month
                  FROM distinct_msr
                  WHERE created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                  GROUP BY 1
              )
              SELECT *
              FROM msr_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: msrs_cadastradas_por_mes
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 1889345f-016e-4b2c-80de-fb1636b8fa13
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: f4161324-1f31-49c8-a1ad-0f1a04b9b6ad
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: mês
                    dataFrameColumn: month
                  series:
                    - id: 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      type: line
                      axis:
                        type: number
                        style:
                          max: 400
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "     "
                        aggregate: sum
                      dataFrameColumns:
                        - msr_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#451952"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: above
                      point: true
                      stroke: solid
                      width: 3
                  dataFrame: msrs_cadastradas_por_mes
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: c002bb69-1b10-47d1-b372-a3b49ef81ba5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Pedidos de acolhimento
    config:
      source: |-
        # Pedidos de acolhimento
        Cada MSR pode pedir até dois pedidos de acolhimento: um psicológico e um jurídico. Solicitações repetidas não estão contabilizadas.
  - cellType: MARKDOWN
    cellId: afedb86f-ee9b-4cda-8d20-82000ca4f84a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Série histórica
    config:
      source: "##### Série histórica"
  - cellType: BLOCK
    cellId: 019bc48d-670c-411e-8aec-4609d2054d2a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: bd1e7eb7-53d6-4a21-a675-c618354b8000
        chartCellId: f53729ca-5e93-4b56-8a94-3ca0a23d2c30
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: bd1e7eb7-53d6-4a21-a675-c618354b8000
          cellLabel: total
          config:
            source: |-
              WITH support_request_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS support_request_per_year
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(support_request_per_year) OVER(ORDER BY year)::INT AS cumulative_support_request_count
              FROM support_request_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_total
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: f53729ca-5e93-4b56-8a94-3ca0a23d2c30
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: area
                      axis:
                        type: number
                        style:
                          max: 25000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "   "
                        aggregate: sum
                      dataFrameColumns:
                        - cumulative_support_request_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ffa600"
                      opacity:
                        type: static
                        value: 0.4
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: above-left
                      line: true
                      point: true
                      normalize: false
                  dataFrame: pedidos_de_acolhimento_total
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_2
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 5d50e3e7-741e-43ea-8cd9-19a3475a8615 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 838856fc-81e0-4c56-bd35-543b18e2a722
        chartCellId: 960089ca-c702-4bec-877b-e1ad907c1438
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 838856fc-81e0-4c56-bd35-543b18e2a722
          cellLabel: por ano
          config:
            source: |-
              WITH support_request_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS support_request_per_year
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(support_request_per_year) OVER(ORDER BY year)::INT AS cumulative_support_request_count
              FROM support_request_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_ano
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 960089ca-c702-4bec-877b-e1ad907c1438
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 7000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "      "
                        aggregate: sum
                      dataFrameColumns:
                        - support_request_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ffa600"
                      opacity:
                        type: static
                        value: 0.6
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_ano
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_7
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: cb616c07-c544-4e05-b161-6131d006a4d5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 015535df-0080-49e2-b500-c495c5850131
        chartCellId: 74dc11fd-9684-43b9-a122-c19c9d57b221
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 015535df-0080-49e2-b500-c495c5850131
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH support_request_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      COUNT(*) AS support_request_per_month
                  FROM match.support_requests
                  WHERE 
                      created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                      AND status != 'duplicated'
                  GROUP BY 1
              )
              SELECT *
              FROM support_request_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_mes
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 74dc11fd-9684-43b9-a122-c19c9d57b221
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: f4161324-1f31-49c8-a1ad-0f1a04b9b6ad
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: mês
                    dataFrameColumn: month
                  series:
                    - id: 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      type: line
                      axis:
                        type: number
                        style:
                          max: 500
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - support_request_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ffa600"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: above
                      point: true
                      stroke: solid
                      width: 3
                  dataFrame: pedidos_de_acolhimento_por_mes
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_3
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: 447de4f4-a368-4494-a61c-2745bdaaf06a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Por território
    config:
      source: "##### Por território"
  - cellType: INPUT
    cellId: 1c55bd0e-de54-4cb9-845e-4b5a78992a2e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Período
    config:
      inputType: DROPDOWN
      name: support_request_time_filter
      outputType: STRING
      options:
        valueOptions:
          - Filtrar apenas o último ano
          - Desde o início do Mapa
      defaultValue: Filtrar apenas o último ano
  - cellType: BLOCK
    cellId: 744e0c76-de8d-4909-89e7-134ebda67c6f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: e2b99b3d-df80-4357-8e7b-b82ab776b72e
        chartCellId: 5a8eb824-162c-4cb7-9088-71ed2303313f
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: e2b99b3d-df80-4357-8e7b-b82ab776b72e
          cellLabel: por estado
          config:
            source: |-
              SELECT
                  state,
                  COUNT(*)
              FROM match.support_requests
              WHERE 
                  status != 'duplicated'
                  AND state != 'not_found'
                  AND created_at >= CASE WHEN {{ support_request_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY state
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_estado
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: count
                  renameTo: null
                  size: 85
                  wrapText: null
                  displayFormat: null
                - originalName: state
                  renameTo: null
                  size: 82
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 5a8eb824-162c-4cb7-9088-71ed2303313f
          cellLabel: por estado
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: e6ed243e-00e3-4439-9d5e-b6ab3f57213b
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    dataFrameColumn: state
                  series:
                    - id: 8e2d44ac-b336-4aa9-90dd-0981a7f73d58
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ffa600"
                      opacity:
                        type: static
                        value: 0.6
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_estado
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: e5a0bf5e-a0ea-46f1-97a9-ad98914f9d80 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 7810c2a3-04b0-4b7f-8cba-567a6b95d632
        chartCellId: 8677e808-6e42-4caf-a46a-26ca27ca5a4f
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 7810c2a3-04b0-4b7f-8cba-567a6b95d632
          cellLabel: por região
          config:
            source: |-
              SELECT
                  CASE
                      WHEN state IN ('AM', 'PA', 'AC', 'RR', 'RO', 'AP', 'TO') THEN 'norte'
                      WHEN state IN ('MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA') THEN 'nordeste'
                      WHEN state IN ('SP', 'RJ', 'MG', 'ES') THEN 'sudeste'
                      WHEN state IN ('MT', 'MS', 'GO', 'DF') THEN 'centro-oeste'
                      WHEN state IN ('PR', 'SC', 'RS') THEN 'sul'
                      WHEN state = 'INT' THEN 'internacional'
                      ELSE 'não encontrado'
                  END AS region,
                  CASE 
                      WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                     ELSE 'não capital'
                  END AS capital,
                  COUNT(*) AS pedidos_de_acolhimento_per_state
              FROM match.support_requests
              WHERE
                  status != 'duplicated'
                  AND created_at >= CASE WHEN {{ support_request_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY 1, 2
              ORDER BY 2 DESC
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 8677e808-6e42-4caf-a46a-26ca27ca5a4f
          cellLabel: por região
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    dataFrameColumn: region
                  series:
                    - id: 869bd0ad-ff24-4857-9461-8bea4192132b
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - pedidos_de_acolhimento_per_state
                      colorDataFrameColumn: capital
                      colorOrder: descending
                      color:
                        type: series
                        defaultColor: "#ffa600"
                        colorsBySeriesValues:
                          capital: "#ffa600"
                          não capital: "#ffeac4"
                      opacity:
                        type: series
                        opacitiesBySeriesValues:
                          capital: 0.6
                          não capital: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        position: outside-end
                      legendTitle: "     "
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_regiao
              settings:
                legend:
                  position: top
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              capital: "#BAB0AC"
              não capital: "#EECA3B"
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 8f68ba1f-5c19-41e6-b838-79c7ebd7aac6 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 333a89b1-3bd7-4a43-8bb2-d17184ba98f7
        chartCellId: 0f21fc9c-4e76-4eb2-9dc4-29c131f213e9
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 333a89b1-3bd7-4a43-8bb2-d17184ba98f7
          cellLabel: capitais x não capitais
          config:
            source: |+
              SELECT
                  CASE 
                      WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                     ELSE 'não capital'
                  END AS capital,
                  COUNT(*)
              FROM match.support_requests
              WHERE 
                  status != 'duplicated'
                  AND created_at >= CASE WHEN {{ support_request_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              AND city != 'not_found'
              GROUP BY 1

            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_capitais
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 0f21fc9c-4e76-4eb2-9dc4-29c131f213e9
          cellLabel: capitais x não capitais
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: e54ae934-f6c1-4056-a21e-d9a67297a414
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels:
                        angle: 0
                    title: "    "
                    dataFrameColumn: capital
                  series:
                    - id: b65f5fbb-42bc-40e3-a359-3f4638a63668
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 3
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - count
                      colorDataFrameColumn: capital
                      colorOrder: descending
                      color:
                        type: series
                        colorsBySeriesValues:
                          capital: "#ffa600"
                          não capital: "#ffeac4"
                      opacity:
                        type: series
                        opacitiesBySeriesValues:
                          capital: 0.6
                          não capital: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_capitais
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              capital: "#4C78A8"
              não capital: "#F58518"
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: ce102719-ed51-4922-b9cf-6068d86f6629 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 4cc12feb-bf66-4980-87eb-505c1f98109e
        chartCellId: 7784dcec-f50e-46c2-b95d-9a9c4f936dfd
        activeTab: preview
      cells:
        - cellType: SQL
          cellId: 4cc12feb-bf66-4980-87eb-505c1f98109e
          cellLabel: lat lng
          config:
            source: |
              SELECT  
                  lat,
                  lng
              FROM match.support_requests
              WHERE 
                      status != 'duplicated' 
                      AND lat IS NOT NULL
                      AND lng IS NOT NULL
                      AND created_at >= CASE WHEN {{ support_request_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_lat_lng
            useRichDisplay: false
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: lat
                  renameTo: null
                  size: 162
                  wrapText: null
                  displayFormat: null
                - originalName: lng
                  renameTo: null
                  size: 83
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 7784dcec-f50e-46c2-b95d-9a9c4f936dfd
          cellLabel: lat lng
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: ab50d6e1-8f61-4cc2-9d9e-7fec411eaac3
                  xAxis:
                    type: string
                    style:
                      grid:
                        style: solid
                      ticks: {}
                      labels: {}
                  series:
                    - id: a5009f5b-267d-4bc8-a416-ae86bcab21f9
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: solid
                          ticks: {}
                          labels: {}
                        aggregate: sum
                      dataFrameColumns:
                        - lat
                      colorOrder: ascending
                      color:
                        type: static
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_lat_lng
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: MAP
    cellId: 74c2d5b1-55cc-4007-a1d3-93a3414fdb4f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: mapa
    config:
      height: 520
      map:
        theme: light
        layers:
          - id: 2dbdf358-7747-4252-bc29-ab795295ca1f
            data:
              coordinates:
                system: latlng_separate
                dataFrameColumn: lng
                dataFrameLatColumn: lat
                dataFrameLngColumn: lng
              dataFrameName: pedidos_de_acolhimento_lat_lng
            fill:
              type: static
              color:
                - 255
                - 166
                - 0
              opacity: 0.49
            type: scatter
            radius:
              type: static
              value: 14
            opacity: 1
            visible: true
            tooltipDataFrameColumns: []
        initialView:
          zoom: 3.116329495051001
          pitch: 0
          width: 1100
          height: 520
          bearing: 0
          maxZoom: 20
          minZoom: 0
          altitude: 1.5
          latitude: -14.419762431244253
          maxPitch: 60
          minPitch: 0
          position:
            - 0
            - 0
            - 0
          longitude: -72.14417386115838
          normalize: true
        isLegendOpen: false
  - cellType: MARKDOWN
    cellId: 7c1b7718-9b01-4b87-a088-7af3bfae766f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Pedidos de acolhimento psicológicos
    config:
      source: "##### Psicológicos e jurídicos - série histórica"
  - cellType: BLOCK
    cellId: 6fedf45f-8717-4e15-9741-16a2079073f4 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: a0bb2f7e-6dff-499e-9a9e-42f927296b23
        chartCellId: eb030a93-b2e8-44c0-931c-e4eaf177c29a
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: a0bb2f7e-6dff-499e-9a9e-42f927296b23
          cellLabel: total
          config:
            source: |-
              WITH support_request_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      CASE WHEN support_type = 'legal' THEN 'jurídico' ELSE 'psicológico' END AS " ",
                      COUNT(*) AS support_request_per_year
                  FROM match.support_requests
                  WHERE 
                      status != 'duplicated'
                  GROUP BY 1, 2
              )
              SELECT
                  *,
                  SUM(support_request_per_year) OVER(PARTITION BY " " ORDER BY year)::INT AS cumulative_support_request_count
              FROM support_request_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: dataframe_7
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_support_request_count
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: support_request_per_year
                  renameTo: null
                  size: 199
                  wrapText: null
                  displayFormat: null
                - originalName: support_type
                  renameTo: null
                  size: 127
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 195
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: eb030a93-b2e8-44c0-931c-e4eaf177c29a
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetVertical:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: a8d9796e-e118-40bf-9071-87a3020b576a
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 6489a1a9-8c35-4d67-924b-d3e1d7cd5987
                      type: area
                      axis:
                        type: number
                        style:
                          max: 25000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "      "
                      dataFrameColumns:
                        - cumulative_support_request_count
                      colorDataFrameColumn: " "
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#ffbc61"
                        colorsBySeriesValues:
                          jurídico: "#665191"
                          psicológico: "#ffbc61"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: above-left
                      line: true
                      point: true
                      normalize: false
                  dataFrame: dataframe_7
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              legal: "#4C78A8"
              jurídico: "#F58518"
              psicológico: "#4C78A8"
              psychological: "#F58518"
            resultVariable: filter_result_16
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 2ca9deb4-d40b-4775-8817-5fb3f6df915d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 03efd6de-4a86-4e29-94b6-79dc5c5562ae
        chartCellId: 71980e6c-18b1-480c-836c-95efe9cf4707
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 03efd6de-4a86-4e29-94b6-79dc5c5562ae
          cellLabel: por ano
          config:
            source: |-
              WITH support_request_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      CASE WHEN support_type = 'legal' THEN 'jurídico' ELSE 'psicológico' END AS " ",
                      COUNT(*) AS support_request_per_year
                  FROM match.support_requests
                  WHERE 
                      status != 'duplicated'
                  GROUP BY 1, 2
              )
              SELECT
                  *,
                  SUM(support_request_per_year) OVER(PARTITION BY " " ORDER BY year)::INT AS cumulative_support_request_count
              FROM support_request_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: dataframe_8
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_support_request_count
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: support_request_per_year
                  renameTo: null
                  size: 199
                  wrapText: null
                  displayFormat: null
                - originalName: support_type
                  renameTo: null
                  size: 127
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 195
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 71980e6c-18b1-480c-836c-95efe9cf4707
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetVertical:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: a8d9796e-e118-40bf-9071-87a3020b576a
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 6489a1a9-8c35-4d67-924b-d3e1d7cd5987
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 7000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "   "
                        aggregate: sum
                      dataFrameColumns:
                        - support_request_per_year
                      colorDataFrameColumn: " "
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#ffbc61"
                        colorsBySeriesValues:
                          jurídico: "#665191"
                          psicológico: "#ffbc61"
                      opacity:
                        type: static
                        value: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: stacked
                  dataFrame: dataframe_8
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              legal: "#665191"
              jurídico: "#665191"
              psicológico: "#ffbc61"
              psychological: "#ff905c"
            resultVariable: filter_result_17
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 99e4296a-4911-465d-b30f-26a4d3c13f88 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: b1cc65dc-3410-4d2c-88eb-a6016297ad9e
        chartCellId: dbb1f16e-80dd-4693-8d46-02aaab1e643b
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: b1cc65dc-3410-4d2c-88eb-a6016297ad9e
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH support_request_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      CASE WHEN support_type = 'legal' THEN 'jurídico' ELSE 'psicológico' END AS " ",
                      COUNT(*) AS support_request_per_month
                  FROM match.support_requests
                  WHERE 
                      created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                      AND status != 'duplicated'
                  GROUP BY 1, 2
              )
              SELECT *
              FROM support_request_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: dataframe_9
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: dbb1f16e-80dd-4693-8d46-02aaab1e643b
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetVertical:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: 8c0a2e08-1cc9-4ccd-98fd-0f3d3b7898dd
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    dataFrameColumn: month
                  series:
                    - id: fb9de481-a2f2-4dfc-955d-205ad16e2d3b
                      type: line
                      axis:
                        type: number
                        style:
                          max: 300
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - support_request_per_month
                      colorDataFrameColumn: " "
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#ffbc61"
                        colorsBySeriesValues:
                          jurídico: "#665191"
                          psicológico: "#ffbc61"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        position: above
                      point: true
                      stroke: solid
                      width: 3
                  dataFrame: dataframe_9
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              legal: "#4C78A8"
              jurídico: "#4C78A8"
              psicológico: "#F58518"
              psychological: "#F58518"
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: 3026fdd4-ece5-438f-befd-9b4521141d02 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      source: "##### Psicológicos e jurídicos - por território"
  - cellType: INPUT
    cellId: a915a006-1d0e-42f6-9552-6aee3a5f9b23 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Período
    config:
      inputType: DROPDOWN
      name: support_request_psy_leg_time_filter
      outputType: STRING
      options:
        valueOptions:
          - Filtrar apenas o último ano
          - Desde o início do Mapa
      defaultValue: Filtrar apenas o último ano
  - cellType: BLOCK
    cellId: 12ae44e7-88f3-4b0f-8139-0e8c0b168c6d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: feb9f58f-eae4-4b0d-b28f-f0105c834130
        chartCellId: 754c71ea-710b-4a83-98b8-208c7c840d68
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: feb9f58f-eae4-4b0d-b28f-f0105c834130
          cellLabel: por estado
          config:
            source: |-
              SELECT
                  state,
                  CASE WHEN support_type = 'psychological' THEN 'psicológico' ELSE 'jurídico' END AS " ",
                  COUNT(*)
              FROM match.support_requests
              WHERE 
                  status != 'duplicated'
                  AND state != 'not_found'
                  AND created_at >= CASE WHEN {{ support_request_psy_leg_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY state, support_type
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_estado_5
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: count
                  renameTo: null
                  size: 85
                  wrapText: null
                  displayFormat: null
                - originalName: state
                  renameTo: null
                  size: 82
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 754c71ea-710b-4a83-98b8-208c7c840d68
          cellLabel: por estado
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetHorizontal:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: e6ed243e-00e3-4439-9d5e-b6ab3f57213b
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    dataFrameColumn: state
                  series:
                    - id: 8e2d44ac-b336-4aa9-90dd-0981a7f73d58
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - count
                      colorDataFrameColumn: " "
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#ffa600"
                        colorsBySeriesValues:
                          jurídico: "#665191"
                          psicológico: "#ffbc61"
                      opacity:
                        type: static
                        value: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        position: outside-end
                      legendTitle: "    "
                      barWidth: 1
                      orientation: horizontal
                      layout: stacked
                  dataFrame: pedidos_de_acolhimento_por_estado_5
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              legal: "#665191"
              jurídico: "#665191"
              psicológico: "#ffbc61"
              psychological: "#ffbc61"
            resultVariable: filter_result_30
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 595d5505-bc35-47c1-bd23-568892dc1c8b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: a48f2b64-e024-4669-a4df-2e7d393ef9b2
        chartCellId: f0166693-dfef-4a68-8542-3bbc8f305844
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: a48f2b64-e024-4669-a4df-2e7d393ef9b2
          cellLabel: capitais x não capitais
          config:
            source: |
              WITH capitals AS (
                  SELECT
                      CASE 
                          WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                          WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                          WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                          WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                          WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                          WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                          WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                          WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                          WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                          WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                          WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                          WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                          WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                          WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                          WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                          WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                          WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                          WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                          WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                          WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                          WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                          WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                          WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                          WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                          WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                          WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                          WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                      ELSE 'não capital'
                      END AS capital,
                      CASE WHEN support_type = 'psychological' THEN 'psicológico' ELSE 'jurídico' END AS " ",
                      COUNT(*)
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  AND city != 'not_found'
                  AND created_at >= CASE WHEN {{ support_request_psy_leg_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
                  GROUP BY 1, 2
              )
              SELECT 
                  *,
                  CONCAT(" ", ' - ', capital) AS color
              FROM capitals
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_capitais_2
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: f0166693-dfef-4a68-8542-3bbc8f305844
          cellLabel: capitais x não capitais
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetHorizontal:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: e54ae934-f6c1-4056-a21e-d9a67297a414
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels:
                        angle: 0
                    title: "    "
                    dataFrameColumn: capital
                  series:
                    - id: b65f5fbb-42bc-40e3-a359-3f4638a63668
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 3
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - count
                      colorDataFrameColumn: color
                      colorOrder: ascending
                      color:
                        type: series
                        colorsBySeriesValues:
                          jurídico - capital: "#58508d"
                          psicológico - capital: "#ffbc61"
                          jurídico - não capital: "#c9c0e7"
                          psicológico - não capital: "#fbdebe"
                      opacity:
                        type: static
                        value: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#3F4257"
                        position: outside-end
                      legendTitle: "   "
                      barWidth: 1
                      orientation: horizontal
                      layout: stacked
                  dataFrame: pedidos_de_acolhimento_capitais_2
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              legal: "#4C78A8"
              capital: "#4C78A8"
              jurídico: "#4C78A8"
              não capital: "#F58518"
              psicológico: "#F58518"
              psychological: "#F58518"
              jurídico - capital: "#4C78A8"
              psicológico - capital: "#E45756"
              jurídico - não capital: "#F58518"
              psicológico - não capital: "#72B7B2"
            resultVariable: filter_result_31
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 123af505-e48d-411f-b22a-7677bff4618f # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 033cb758-847e-4b03-b444-df27bdc16c7b
        chartCellId: 44158400-c9b6-4996-a501-634f250ab3bf
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 033cb758-847e-4b03-b444-df27bdc16c7b
          cellLabel: por região
          config:
            source: |-
              WITH capitals AS (
                  SELECT
                      CASE
                          WHEN state IN ('AM', 'PA', 'AC', 'RR', 'RO', 'AP', 'TO') THEN 'norte'
                          WHEN state IN ('MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA') THEN 'nordeste'
                          WHEN state IN ('SP', 'RJ', 'MG', 'ES') THEN 'sudeste'
                          WHEN state IN ('MT', 'MS', 'GO', 'DF') THEN 'centro-oeste'
                          WHEN state IN ('PR', 'SC', 'RS') THEN 'sul'
                          WHEN state = 'INT' THEN 'internacional'
                          ELSE 'não encontrado'
                      END AS region,
                      CASE 
                          WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                          WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                          WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                          WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                          WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                          WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                          WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                          WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                          WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                          WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                          WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                          WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                          WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                          WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                          WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                          WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                          WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                          WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                          WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                          WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                          WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                          WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                          WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                          WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                          WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                          WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                          WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                      ELSE 'não capital'
                      END AS capital,
                      CASE WHEN support_type = 'psychological' THEN 'psicológico' ELSE 'jurídico' END AS " ",
                      COUNT(*) AS pedidos_de_acolhimento_per_state
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  AND created_at >= CASE WHEN {{ support_request_psy_leg_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
                  GROUP BY 1, 2, 3
                  ORDER BY 2 DESC
              )
              SELECT 
                  *,
                  CONCAT(" ", ' - ', capital) AS color
              FROM capitals
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao_8
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 44158400-c9b6-4996-a501-634f250ab3bf
          cellLabel: por região
          config:
            height: null
            chartSpec:
              type: layered
              facet:
                facetHorizontal:
                  sort: descending
                  type: string
                  dataFrameColumn: " "
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    dataFrameColumn: region
                  series:
                    - id: 869bd0ad-ff24-4857-9461-8bea4192132b
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - pedidos_de_acolhimento_per_state
                      colorDataFrameColumn: color
                      colorOrder: descending
                      color:
                        type: series
                        defaultColor: "#ffa600"
                        colorsBySeriesValues:
                          capitaljurídico: "#665191"
                          capitalpsicológico: "#ffbc61"
                          jurídico - capital: "#58508d"
                          não capitaljurídico: "#aca2d0"
                          psicológico - capital: "#ffbc61"
                          jurídico - não capital: "#c9c0e7"
                          não capitalpsicológico: "#fdd7ac"
                          psicológico - não capital: "#fbdebe"
                      opacity:
                        type: static
                        value: 0.8
                      tooltip:
                        type: auto
                      legendTitle: "     "
                      barWidth: 1
                      orientation: horizontal
                      layout: stacked
                  dataFrame: pedidos_de_acolhimento_por_regiao_8
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              capital: "#BAB0AC"
              não capital: "#EECA3B"
              capitaljurídico: "#665191"
              capital jurídico: "#ffa600"
              capitalpsicológico: "#ffbc61"
              jurídico - capital: "#58508d"
              capital psicológico: "#ffa600"
              não capitaljurídico: "#aca2d0"
              não capital jurídico: "#ffa600"
              psicológico - capital: "#ffbc61"
              jurídico - não capital: "#c9c0e7"
              não capitalpsicológico: "#fdd7ac"
              não capital psicológico: "#ffa600"
              psicológico - não capital: "#fbdebe"
            resultVariable: filter_result_32
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: d7931a8e-450e-45a2-a775-4a29bfee6a5d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Matches
    config:
      source: |-
        # Matches
        Total de pedidos de acolhimento que receberam um match, considerando todos os tipos de match.
  - cellType: MARKDOWN
    cellId: 15cf8346-acf8-4198-9033-67ac7e863268 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Série histórica
    config:
      source: "##### Série histórica"
  - cellType: BLOCK
    cellId: 7ffd6e4e-687e-412e-9088-ec1ba50d758b # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: ad110c7f-feb1-438a-867f-54a74489116c
        chartCellId: 510ac6d2-9ab0-4fc1-9f02-84e85a2c6146
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: ad110c7f-feb1-438a-867f-54a74489116c
          cellLabel: total
          config:
            source: |-
              WITH matches_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS support_requests_per_year,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS matches_per_year
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  GROUP BY 1
              ),
              cumulative_sums AS (
                  SELECT
                      *,
                      SUM(matches_per_year) OVER(ORDER BY year)::INT AS cumulative_match_count,
                      SUM(support_requests_per_year) OVER(ORDER BY year)::INT AS cumulative_support_request_count
                  FROM matches_per_year

              )
              SELECT
                  *,
                  cumulative_match_count/cumulative_support_request_count::NUMERIC(10,4) AS percentage
              FROM cumulative_sums
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: matches_total
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: ?column?
                  renameTo: null
                  size: 106
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_match_count
                  renameTo: null
                  size: 191
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_support_request_count
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: matches_per_year
                  renameTo: null
                  size: 155
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
                - originalName: support_requests_per_year
                  renameTo: null
                  size: 204
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 510ac6d2-9ab0-4fc1-9f02-84e85a2c6146
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: d5444521-df70-4d96-83b1-cf2096a1c48b
                      name: pedidos de acolhimento
                      type: area
                      axis:
                        type: number
                        style:
                          max: 30000
                          min: 0
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: NUMBER
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - cumulative_support_request_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#CFD3DE"
                      opacity:
                        type: static
                        value: 0.2
                      tooltip:
                        type: manual
                        fields: []
                      line: true
                      point: true
                      normalize: false
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      name: matches
                      type: area
                      axis:
                        type: number
                        style:
                          max: 30000
                          min: 0
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: NUMBER
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - cumulative_match_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.6
                      tooltip:
                        type: manual
                        fields: []
                      dataLabels:
                        fontSize: 10
                        position: above-left
                      line: true
                      point: true
                      normalize: false
                    - id: 4b25e076-8eec-4e6c-9c90-2545ce0f0a59
                      name: porcentagem de matches
                      type: scatter
                      axis:
                        type: number
                        style:
                          max: 0.55
                          ticks:
                            count: 0
                          labels: {}
                        title: "   "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: above
                      filled: true
                      shape: triangle-down
                      size: 10
                  dataFrame: matches_total
                  seriesGroups:
                    - - d5444521-df70-4d96-83b1-cf2096a1c48b
                      - 80616841-4fb3-4d01-8525-df2bab0f19a6
                    - - 4b25e076-8eec-4e6c-9c90-2545ce0f0a59
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              "4365": "#4C78A8"
              "10146": "#4C78A8"
              "14838": "#4C78A8"
              "18154": "#4C78A8"
              "21022": "#4C78A8"
              "21163": "#4C78A8"
              "1546308000000": "#4C78A8"
              "1577847600000": "#4C78A8"
              "1609470000000": "#4C78A8"
              "1641006000000": "#4C78A8"
              "1672542000000": "#4C78A8"
              "1704078000000": "#4C78A8"
            resultVariable: filter_result_4
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 3282e6da-85c4-453f-8b5b-ddccc8b77dc2 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: d78b13e7-d70f-494e-8bdd-73e95f6f9deb
        chartCellId: c73f170d-39e8-4f66-8786-133cff896288
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: d78b13e7-d70f-494e-8bdd-73e95f6f9deb
          cellLabel: por ano
          config:
            source: |-
              WITH matches_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS support_requests_per_year,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS matches_per_year
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  GROUP BY 1
              )
              SELECT
                  *,
                  matches_per_year/support_requests_per_year::NUMERIC(10,4) AS percentage
              FROM matches_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: matches_por_ano
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: ?column?
                  renameTo: null
                  size: 106
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: matches_per_year
                  renameTo: null
                  size: 155
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 164
                  wrapText: null
                  displayFormat: null
                - originalName: support_requests_per_year
                  renameTo: null
                  size: 204
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: c73f170d-39e8-4f66-8786-133cff896288
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: c702ece5-13f0-4de0-82ef-cb47f6b7a053
                      name: pedidos de acolhimento
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 8000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - support_requests_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#CFD3DE"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      name: matches
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 8000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - matches_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                    - id: 0e06aefa-c6fd-4152-8985-8b430dd262ed
                      name: porcentagem de matches
                      type: scatter
                      axis:
                        type: number
                        style:
                          max: 0.8
                          min: -1
                          ticks:
                            count: 0
                          labels: {}
                        title: "   "
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        position: above
                      filled: true
                      shape: triangle-down
                      size: 10
                  dataFrame: matches_por_ano
                  seriesGroups:
                    - - c702ece5-13f0-4de0-82ef-cb47f6b7a053
                      - 80616841-4fb3-4d01-8525-df2bab0f19a6
                    - - 0e06aefa-c6fd-4152-8985-8b430dd262ed
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_8
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: d87facf9-fe4c-40d8-8a54-82b720df504d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: c5755ce5-d9ca-4537-a922-9a9298a5c49a
        chartCellId: 43e4c512-af02-466b-b2b0-a390ba46c3b5
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: c5755ce5-d9ca-4537-a922-9a9298a5c49a
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH matches_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      COUNT(*) AS support_requests_per_month,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS matches_per_month
                  FROM match.support_requests
                  WHERE 
                      created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                      AND status != 'duplicated'
                  GROUP BY 1
              )
              SELECT 
                  *,
                  matches_per_month/support_requests_per_month::NUMERIC(10,4) AS percentage
              FROM matches_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: matches_por_mes
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 43e4c512-af02-466b-b2b0-a390ba46c3b5
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: f4161324-1f31-49c8-a1ad-0f1a04b9b6ad
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: mês
                    dataFrameColumn: month
                  series:
                    - id: 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      name: matches
                      type: line
                      axis:
                        type: number
                        style:
                          max: 600
                          grid:
                            style: dash
                          ticks:
                            count: 8
                          labels: {}
                        title: "          "
                        aggregate: sum
                      dataFrameColumns:
                        - matches_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: above
                      point: true
                      stroke: solid
                      width: 2
                    - id: cbf171bd-c443-496f-b4c2-1e4a8d6a7a8e
                      name: pedidos de acolhimento
                      type: line
                      axis:
                        type: number
                        style:
                          max: 600
                          grid:
                            style: dash
                          ticks:
                            count: 8
                          labels: {}
                        title: "          "
                        aggregate: sum
                      dataFrameColumns:
                        - support_requests_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#CFD3DE"
                      opacity:
                        type: static
                        value: 0.6
                      tooltip:
                        type: auto
                      point: true
                      stroke: solid
                      width: 2
                    - id: 6ed881c8-b941-4b7a-98aa-e72bdaeeb90e
                      name: porcetagem de matches
                      type: scatter
                      axis:
                        type: number
                        style:
                          max: 0.8
                          min: -1
                          ticks:
                            count: 0
                          labels: {}
                        title: "   "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 8
                        position: above
                      filled: true
                      shape: triangle-down
                      size: 10
                  dataFrame: matches_por_mes
                  seriesGroups:
                    - - 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      - cbf171bd-c443-496f-b4c2-1e4a8d6a7a8e
                    - - 6ed881c8-b941-4b7a-98aa-e72bdaeeb90e
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_5
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: 76ed1a7e-4871-411b-adf4-1e1f9d5a2db5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Por território
    config:
      source: "##### Por território"
  - cellType: INPUT
    cellId: 9c0f378c-4506-441a-9260-281715116532 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Período
    config:
      inputType: DROPDOWN
      name: match_time_filter
      outputType: STRING
      options:
        valueOptions:
          - Filtrar apenas o último ano
          - Desde o início do Mapa
      defaultValue: Filtrar apenas o último ano
  - cellType: BLOCK
    cellId: ba346d41-d6e3-4bb4-8069-989971c455e1 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: af8a806b-ece4-4f14-8475-868327899a5c
        chartCellId: e7193788-a908-4c7c-92c8-0117059498e7
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: af8a806b-ece4-4f14-8475-868327899a5c
          cellLabel: por estado
          config:
            source: |
              WITH matches_per_state AS (
                  SELECT
                      state,
                      COUNT(*) AS support_request_count,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS match_count
                  FROM match.support_requests
                  WHERE 
                      status != 'duplicated'
                      AND state NOT IN ('not_found', 'INT')
                      AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
                  GROUP BY 1
              )
              SELECT
                  state,
                  match_count,
                  support_request_count
              FROM matches_per_state
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: matches_por_estado
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: count
                  renameTo: null
                  size: 85
                  wrapText: null
                  displayFormat: null
                - originalName: matched
                  renameTo: null
                  size: 104
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 164
                  wrapText: null
                  displayFormat: null
                - originalName: state
                  renameTo: null
                  size: 82
                  wrapText: null
                  displayFormat: null
                - originalName: support_request_count
                  renameTo: null
                  size: 182
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: e7193788-a908-4c7c-92c8-0117059498e7
          cellLabel: por estado
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: e6ed243e-00e3-4439-9d5e-b6ab3f57213b
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    dataFrameColumn: state
                  series:
                    - id: 8e2d44ac-b336-4aa9-90dd-0981a7f73d58
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: NUMBER
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - match_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: stacked
                  dataFrame: matches_por_estado
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_19
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: f76f97e4-7b75-43f6-b81e-e6096e9183bb # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: cb36e99f-eccc-4087-b583-8fbfa2230d8c
        chartCellId: ef9d7b4a-3e82-4bbc-9007-ab4155a5bc30
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: cb36e99f-eccc-4087-b583-8fbfa2230d8c
          cellLabel: "% por estado"
          config:
            source: |
              WITH matches_per_state AS (
                  SELECT
                      state,
                      COUNT(*) AS support_request_count,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS match_count
                  FROM match.support_requests
                  WHERE 
                      status != 'duplicated'
                      AND state NOT IN ('not_found', 'INT')
                      AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
                  GROUP BY 1
              )
              SELECT
                  state,
                  match_count/support_request_count::NUMERIC(10,4) AS percentage
              FROM matches_per_state
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_estado_4
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: count
                  renameTo: null
                  size: 85
                  wrapText: null
                  displayFormat: null
                - originalName: matched
                  renameTo: null
                  size: 104
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 164
                  wrapText: null
                  displayFormat: null
                - originalName: state
                  renameTo: null
                  size: 82
                  wrapText: null
                  displayFormat: null
                - originalName: support_request_count
                  renameTo: null
                  size: 182
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: ef9d7b4a-3e82-4bbc-9007-ab4155a5bc30
          cellLabel: "% de matches"
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: e6ed243e-00e3-4439-9d5e-b6ab3f57213b
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "     "
                    dataFrameColumn: state
                  series:
                    - id: 8e2d44ac-b336-4aa9-90dd-0981a7f73d58
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 1
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: stacked
                  dataFrame: pedidos_de_acolhimento_por_estado_4
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              matched: "#ff7c43"
              not_matched: "#CFD3DE"
            resultVariable: filter_result_18
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: ce6002ef-b214-4b19-9fcd-8ab8c9671934 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: f51126e1-9a1b-4cab-b393-8a27082cbf59
        chartCellId: 66fbbf42-dce7-41a0-84c1-f9daf8e15b4c
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: f51126e1-9a1b-4cab-b393-8a27082cbf59
          cellLabel: por região
          config:
            source: |-
              SELECT
                  CASE
                      WHEN state IN ('AM', 'PA', 'AC', 'RR', 'RO', 'AP', 'TO') THEN 'norte'
                      WHEN state IN ('MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA') THEN 'nordeste'
                      WHEN state IN ('SP', 'RJ', 'MG', 'ES') THEN 'sudeste'
                      WHEN state IN ('MT', 'MS', 'GO', 'DF') THEN 'centro-oeste'
                      WHEN state IN ('PR', 'SC', 'RS') THEN 'sul'
                      WHEN state = 'INT' THEN 'internacional'
                      ELSE 'não encontrado'
                  END AS region,
                  CASE 
                      WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                     ELSE 'não capital'
                  END AS capital,
                  COUNT(*) AS pedidos_de_acolhimento_per_state
              FROM match.support_requests
              WHERE 
                  status = 'matched'
                  AND state NOT IN ('INT', 'not_found')
                  AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY 1, 2
              ORDER BY 2 DESC
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao_3
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 66fbbf42-dce7-41a0-84c1-f9daf8e15b4c
          cellLabel: por região
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    dataFrameColumn: region
                  series:
                    - id: 869bd0ad-ff24-4857-9461-8bea4192132b
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - pedidos_de_acolhimento_per_state
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#ff7c43"
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_regiao_3
              settings:
                legend:
                  position: top
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_20
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 3411c30a-b1cf-4f75-a5a6-4a83eced8196 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 85162751-d5fb-4e48-b9f2-1fd4aab3a365
        chartCellId: 2f7b070f-9500-41e8-a1f7-3a56d5e8bfd1
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 85162751-d5fb-4e48-b9f2-1fd4aab3a365
          cellLabel: "% de matches"
          config:
            source: |
              WITH matches_per_region AS (
                  SELECT
                      CASE
                          WHEN state IN ('AM', 'PA', 'AC', 'RR', 'RO', 'AP', 'TO') THEN 'norte'
                          WHEN state IN ('MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA') THEN 'nordeste'
                          WHEN state IN ('SP', 'RJ', 'MG', 'ES') THEN 'sudeste'
                          WHEN state IN ('MT', 'MS', 'GO', 'DF') THEN 'centro-oeste'
                          WHEN state IN ('PR', 'SC', 'RS') THEN 'sul'
                          WHEN state = 'INT' THEN 'internacional'
                          ELSE 'não encontrado'
                      END AS region,
                      -- CASE 
                      --     WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      --     WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      --     WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      --     WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      --     WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      --     WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      --     WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      --     WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      --     WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      --     WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      --     WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      --     WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      --     WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      --     WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      --     WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      --     WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      --     WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      --     WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      --     WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      --     WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      --     WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      --     WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      --     WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      --     WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      --     WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      --     WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      --     WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                      --    ELSE 'não capital'
                      -- END AS capital,
                      COUNT(*) AS pedidos_de_acolhimento_per_region,
                      SUM(CASE WHEN status='matched' THEN 1 ELSE 0 END) AS matches_per_region
                  FROM match.support_requests
                  WHERE status != 'duplicated'
                  AND state NOT IN ('INT', 'not_found')
                  AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
                  GROUP BY 1
              )
              SELECT 
                  *,
                  matches_per_region/pedidos_de_acolhimento_per_region::NUMERIC(10,4) AS percentage
              FROM matches_per_region
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao_7
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: capital
                  renameTo: null
                  size: 91
                  wrapText: null
                  displayFormat: null
                - originalName: matches_per_state
                  renameTo: null
                  size: 158
                  wrapText: null
                  displayFormat: null
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 2f7b070f-9500-41e8-a1f7-3a56d5e8bfd1
          cellLabel: "% de matches"
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    sort: -x
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels:
                        angle: 0
                    title: "   "
                    dataFrameColumn: region
                  series:
                    - id: 77975e42-03bc-47e9-a489-b73ba489a4f6
                      name: porcentagem de matches
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 1
                          min: 0
                          ticks:
                            count: 5
                          labels: {}
                        title: "   "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_regiao_7
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_25
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 056b96fb-2d25-44c2-941a-c7f7bc99535e # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 95611aa9-f668-4c91-be28-2593a0c275eb
        chartCellId: 10883f9a-5dbf-424e-a33f-a102a6ecb245
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 95611aa9-f668-4c91-be28-2593a0c275eb
          cellLabel: capital x não capital
          config:
            source: |-
              SELECT
                  CASE 
                      WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                     ELSE 'não capital'
                  END AS capital,
                  COUNT(*) AS pedidos_de_acolhimento_per_state
              FROM match.support_requests
              WHERE 
                  status = 'matched'
                  AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY 1
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao_5
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: capital
                  renameTo: null
                  size: 91
                  wrapText: null
                  displayFormat: null
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 10883f9a-5dbf-424e-a33f-a102a6ecb245
          cellLabel: capital x não capital
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    sort: ascending
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    dataFrameColumn: capital
                  series:
                    - id: 869bd0ad-ff24-4857-9461-8bea4192132b
                      type: bar
                      axis:
                        type: number
                        style:
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - pedidos_de_acolhimento_per_state
                      colorDataFrameColumn: capital
                      colorOrder: descending
                      color:
                        type: series
                        defaultColor: "#ffa600"
                        colorsBySeriesValues:
                          capital: "#ff7c43"
                          não capital: "#ffd9c6"
                      opacity:
                        type: series
                        opacitiesBySeriesValues:
                          capital: 0.7
                          não capital: 0.8
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#ff7c43"
                        fontSize: 10
                        position: outside-end
                      legendTitle: "     "
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_regiao_5
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              capital: "#ff7c43"
              não capital: "#ffd9c6"
            resultVariable: filter_result_22
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 156ec4e7-720b-421c-942f-172c818dea4a # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 5fbf364b-8b56-4ec5-a262-7228fb8bef88
        chartCellId: fbf21fd7-28e2-47ba-bb93-2b8115003e6e
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 5fbf364b-8b56-4ec5-a262-7228fb8bef88
          cellLabel: "% de matches"
          config:
            source: |-
              WITH matches_per_capital AS (
              SELECT
                  CASE 
                      WHEN city = 'RIO BRANCO' AND state = 'AC' THEN 'capital'
                      WHEN city = 'MACEIO' AND state = 'AL' THEN 'capital'
                      WHEN city = 'MACAPA' AND state = 'AP' THEN 'capital'
                      WHEN city = 'MANAUS' AND state = 'AM' THEN 'capital'
                      WHEN city = 'SALVADOR' AND state = 'BA' THEN 'capital'
                      WHEN city = 'FORTALEZA' AND state = 'CE' THEN 'capital'
                      WHEN city = 'BRASILIA' AND state = 'DF' THEN 'capital'
                      WHEN city = 'VITORIA' AND state = 'ES' THEN 'capital'
                      WHEN city = 'GOIANIA' AND state = 'GO' THEN 'capital'
                      WHEN city = 'SAO LUIS' AND state = 'MA' THEN 'capital'
                      WHEN city = 'CUIABA' AND state = 'MT' THEN 'capital'
                      WHEN city = 'CAMPO GRANDE' AND state = 'MS' THEN 'capital'
                      WHEN city = 'BELO HORIZONTE' AND state = 'BH' THEN 'capital'
                      WHEN city = 'BELEM' AND state = 'PA' THEN 'capital'
                      WHEN city = 'JOAO PESSOA' AND state = 'PB' THEN 'capital'
                      WHEN city = 'CURITIBA' AND state = 'PR' THEN 'capital'
                      WHEN city = 'RECIFE' AND state = 'PE' THEN 'capital'
                      WHEN city = 'TERESINA' AND state = 'PI' THEN 'capital'
                      WHEN city = 'RIO DE JANEIRO' AND state = 'RJ' THEN 'capital'
                      WHEN city = 'NATAL' AND state = 'RN' THEN 'capital'
                      WHEN city = 'PORTO ALEGRE' AND state = 'RS' THEN 'capital'
                      WHEN city = 'PORTO VELHO' AND state = 'RO' THEN 'capital'
                      WHEN city = 'BOA VISTA' AND state = 'RR' THEN 'capital'
                      WHEN city = 'FLORIANOPOLIS' AND state = 'SC' THEN 'capital'
                      WHEN city = 'SAO PAULO' AND state = 'SP' THEN 'capital'
                      WHEN city = 'ARACAJU' AND state = 'SE' THEN 'capital'
                      WHEN city = 'PALMAS' AND state = 'TO' THEN 'capital'
                     ELSE 'não capital'
                  END AS capital,
                  COUNT(*) AS support_request_count,
                  SUM(CASE WHEN status='matched' THEN 1 ELSE 0 END) AS match_count
              FROM match.support_requests
              WHERE 
                  status != 'duplicated'
                  AND state NOT IN ('INT', 'not_found')
                  AND created_at >= CASE WHEN {{ match_time_filter }} = 'Filtrar apenas o último ano' THEN CURRENT_DATE - INTERVAL '1 YEAR' ELSE '2010-01-01' END
              GROUP BY 1
              )
              SELECT
                  capital,
                  match_count/support_request_count::NUMERIC(10,4) AS percentage
              FROM matches_per_capital
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: pedidos_de_acolhimento_por_regiao_6
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: ?column?
                  renameTo: null
                  size: 164
                  wrapText: null
                  displayFormat: null
                - originalName: capital
                  renameTo: null
                  size: 91
                  wrapText: null
                  displayFormat: null
                - originalName: pedidos_de_acolhimento_per_state
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 164
                  wrapText: null
                  displayFormat: null
                - originalName: region
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: fbf21fd7-28e2-47ba-bb93-2b8115003e6e
          cellLabel: "% de matches"
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 95f13c33-fbb3-4c3a-aa26-37f46edb6d69
                  xAxis:
                    type: string
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: "   "
                    dataFrameColumn: capital
                  series:
                    - id: cdb91bb6-1d73-47c0-9541-9ba68c72a387
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 1
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorDataFrameColumn: capital
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#ffa600"
                        colorsBySeriesValues:
                          capital: "#003f5c"
                          não capital: "#9cc3dc"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        color: "#003f5c"
                        position: outside-end
                      legendTitle: "   "
                      barWidth: 1
                      orientation: horizontal
                      layout: grouped
                  dataFrame: pedidos_de_acolhimento_por_regiao_6
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              capital: "#003f5c"
              não capital: "#9cc3dc"
            resultVariable: filter_result_23
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: 380f6aad-6135-4bf2-a747-a07cc8b7e3e5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Matches psicológicos
    config:
      source: "##### Matches psicológicos"
  - cellType: BLOCK
    cellId: e802d17c-5109-45b0-bf98-4b81dcaf88c0 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: e475b601-1cb5-4ed9-8c4c-6a219df1e77d
        chartCellId: 2011dd30-8600-4c81-af99-b38dcbcec4bb
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: e475b601-1cb5-4ed9-8c4c-6a219df1e77d
          cellLabel: total
          config:
            source: |-
              WITH matches_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS support_requests_per_year,
                      SUM(CASE WHEN status = 'matched' THEN 1 ELSE 0 END) AS matches_per_year
                  FROM match.support_requests
                  WHERE 
                      status != 'duplicated'
                      AND support_type = 'psychological'
                  GROUP BY 1
              ),
              cumulative_sums AS (
                  SELECT
                      *,
                      SUM(matches_per_year) OVER(ORDER BY year)::INT AS cumulative_match_count,
                      SUM(support_requests_per_year) OVER(ORDER BY year)::INT AS cumulative_support_request_count
                  FROM matches_per_year

              )
              SELECT
                  *,
                  cumulative_match_count/cumulative_support_request_count::NUMERIC(10,4) AS percentage
              FROM cumulative_sums
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: matches_total_2
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: ?column?
                  renameTo: null
                  size: 106
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_match_count
                  renameTo: null
                  size: 191
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: cumulative_support_request_count
                  renameTo: null
                  size: 247
                  wrapText: null
                  displayFormat: null
                - originalName: matches_per_year
                  renameTo: null
                  size: 155
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: percentage
                  renameTo: null
                  size: 116
                  wrapText: null
                  displayFormat: null
                - originalName: support_requests_per_year
                  renameTo: null
                  size: 204
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 2011dd30-8600-4c81-af99-b38dcbcec4bb
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: d5444521-df70-4d96-83b1-cf2096a1c48b
                      name: pedidos de acolhimento
                      type: area
                      axis:
                        type: number
                        style:
                          max: 30000
                          min: 0
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: NUMBER
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - cumulative_support_request_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#CFD3DE"
                      opacity:
                        type: static
                        value: 0.2
                      tooltip:
                        type: manual
                        fields: []
                      line: true
                      point: true
                      normalize: false
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      name: matches
                      type: area
                      axis:
                        type: number
                        style:
                          max: 30000
                          min: 0
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                        numberFormat:
                          format: NUMBER
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - cumulative_match_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#ff7c43"
                      opacity:
                        type: static
                        value: 0.6
                      tooltip:
                        type: manual
                        fields: []
                      dataLabels:
                        fontSize: 10
                        position: above-left
                      line: true
                      point: true
                      normalize: false
                    - id: 4b25e076-8eec-4e6c-9c90-2545ce0f0a59
                      name: porcentagem de matches
                      type: scatter
                      axis:
                        type: number
                        style:
                          max: 0.55
                          ticks:
                            count: 0
                          labels: {}
                        title: "   "
                        aggregate: sum
                        numberFormat:
                          format: PERCENT
                          currency: USD
                          columnType: NUMBER
                          numDecimalDigits: 0
                          abbreviateLargeNumbers: false
                      dataFrameColumns:
                        - percentage
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#003f5c"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: above
                      filled: true
                      shape: triangle-down
                      size: 10
                  dataFrame: matches_total_2
                  seriesGroups:
                    - - d5444521-df70-4d96-83b1-cf2096a1c48b
                      - 80616841-4fb3-4d01-8525-df2bab0f19a6
                    - - 4b25e076-8eec-4e6c-9c90-2545ce0f0a59
              settings:
                legend:
                  position: bottom
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_29
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: af23a142-2a9c-45fe-90a9-1af961cf95a5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Atendimentos realizados
    config:
      source: |-
        # Atendimentos realizados
        Total de matches que iniciaram o atendimento.
  - cellType: BLOCK
    cellId: fb5772c3-f17d-4821-ac09-5d03407892d0 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: c07a5494-cc50-46bf-ad56-da980f301ee7
        chartCellId: 58a0b2af-6251-47bd-9cb3-c308e4e9b7d6
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: c07a5494-cc50-46bf-ad56-da980f301ee7
          cellLabel: total
          config:
            source: |-
              WITH atendimentos_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS atendimentos_per_year,
                      50000 AS goal
                  FROM match.matches
                  WHERE status IN ('in_contact', 'interrupted_after_support', 'completed')
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(atendimentos_per_year) OVER(ORDER BY year)::INT AS cumulative_atendimentos_count
              FROM atendimentos_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_realizados_total
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 58a0b2af-6251-47bd-9cb3-c308e4e9b7d6
          cellLabel: total
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 9d599e25-51f0-45f5-8507-ee3dc3a9f4f3
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: solid
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: e76990b4-be12-4e5a-bdf6-9ca0aa9e5a6e
                      type: area
                      axis:
                        type: number
                        style:
                          max: 55000
                          grid:
                            style: solid
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - cumulative_atendimentos_count
                      colorDataFrameColumn: goal
                      colorOrder: ascending
                      color:
                        type: series
                        defaultColor: "#f95d6a"
                        colorsBySeriesValues:
                          "50000": "#f95d6a"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        position: above
                      line: true
                      point: true
                      normalize: false
                    - id: edc912b8-c4da-4e6a-9998-48aa2d307b0f
                      type: line
                      axis:
                        type: number
                        style:
                          max: 55000
                          grid:
                            style: solid
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - goal
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#111418"
                      opacity:
                        type: static
                        value: 1
                      tooltip:
                        type: auto
                      point: false
                      stroke: dashed
                      width: 2
                  dataFrame: atendimentos_realizados_total
                  seriesGroups:
                    - - e76990b4-be12-4e5a-bdf6-9ca0aa9e5a6e
                      - edc912b8-c4da-4e6a-9998-48aa2d307b0f
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              "50000": "#f95d6a"
            resultVariable: filter_result
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: feb9784e-ece7-4bc9-bd58-389f193e0e47 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: fd12f7b3-3132-41cd-9552-cbd233fc20ba
        chartCellId: ee1b35d9-2eda-4315-96e8-7d8f2b642d53
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: fd12f7b3-3132-41cd-9552-cbd233fc20ba
          cellLabel: por ano
          config:
            source: |-
              WITH atendimentos_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS atendimentos_per_year
                  FROM match.matches
                  WHERE status IN ('in_contact', 'interrupted_after_support', 'completed')
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(atendimentos_per_year) OVER(ORDER BY year)::INT AS cumulative_atendimentos_count
              FROM atendimentos_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_realizados_por_ano
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: ee1b35d9-2eda-4315-96e8-7d8f2b642d53
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 1000
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "      "
                        aggregate: sum
                      dataFrameColumns:
                        - atendimentos_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#f95d6a"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                  dataFrame: atendimentos_realizados_por_ano
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_9
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 807d54f1-005d-4a01-aa7e-873046cd19d8 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 39ec01e8-adf8-4a01-a5e2-c0352fc56c58
        chartCellId: df71f6d2-3a66-4887-a29b-b884f0a3329e
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 39ec01e8-adf8-4a01-a5e2-c0352fc56c58
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH atendimentos_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      COUNT(*) AS atendimentos_per_month
                  FROM match.matches
                  WHERE 
                      created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                      AND status IN ('in_contact', 'interrupted_after_support', 'completed')
                  GROUP BY 1
              )
              SELECT *
              FROM atendimentos_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_realizados_por_mes
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: df71f6d2-3a66-4887-a29b-b884f0a3329e
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: f4161324-1f31-49c8-a1ad-0f1a04b9b6ad
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: mês
                    dataFrameColumn: month
                  series:
                    - id: 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      type: line
                      axis:
                        type: number
                        style:
                          max: 50
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "          "
                        aggregate: sum
                      dataFrameColumns:
                        - atendimentos_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#f95d6a"
                      opacity:
                        type: static
                        value: 0.9
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: above
                      point: true
                      stroke: solid
                      width: 3
                  dataFrame: atendimentos_realizados_por_mes
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_10
            outputResult: false
            displayTableConfig: null
  - cellType: MARKDOWN
    cellId: 9b66307c-bf54-4b4e-bd45-68e09a879047 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: Atendimentos concluídos
    config:
      source: |-
        # Atendimentos concluídos
        Total de matches que estão com `Status do Acolhimento = Atendimento: Concluído`
  - cellType: BLOCK
    cellId: 96f40a35-fb71-4d91-ae24-fc0c221bc26d # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 73c21702-8482-46e7-bbd4-06f7678d63e1
        chartCellId: 497fc6da-c08e-4ef1-a4d5-d25373e5cc41
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 73c21702-8482-46e7-bbd4-06f7678d63e1
          cellLabel: total
          config:
            source: |-
              WITH completed_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS completed_per_year
                  FROM match.matches
                  WHERE status = 'completed'
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(completed_per_year) OVER(ORDER BY year)::INT AS cumulative_completed_count
              FROM completed_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_concluidos_total
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 497fc6da-c08e-4ef1-a4d5-d25373e5cc41
          cellLabel: total
          config:
            height: 540
            chartSpec:
              type: layered
              layers:
                - id: 9d599e25-51f0-45f5-8507-ee3dc3a9f4f3
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: solid
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: e76990b4-be12-4e5a-bdf6-9ca0aa9e5a6e
                      type: area
                      axis:
                        type: number
                        style:
                          max: 600
                          grid:
                            style: solid
                          ticks:
                            count: 5
                          labels: {}
                        title: "    "
                        aggregate: sum
                      dataFrameColumns:
                        - cumulative_completed_count
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#2f4b7c"
                      opacity:
                        type: static
                        value: 0.5
                      tooltip:
                        type: auto
                      dataLabels:
                        position: above
                      line: true
                      point: true
                      normalize: false
                  dataFrame: atendimentos_concluidos_total
              settings:
                legend:
                  position: none
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings:
              "50000": "#f95d6a"
            resultVariable: filter_result_11
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 8502d2d5-3c8a-4e5d-896b-2569e2cfc3c5 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 39e81d7f-82ed-4ce8-9ac7-9d9bd2ecc7ee
        chartCellId: 001c8456-6f75-41c0-97c3-cffa836dee7a
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 39e81d7f-82ed-4ce8-9ac7-9d9bd2ecc7ee
          cellLabel: por ano
          config:
            source: |-
              WITH completed_per_year AS (
                  SELECT
                      DATE_TRUNC('year', created_at) AS year,
                      COUNT(*) AS completed_per_year
                  FROM match.matches
                  WHERE status = 'completed'
                  GROUP BY 1
              )
              SELECT
                  *,
                  SUM(completed_per_year) OVER(ORDER BY year)::INT AS cumulative_completed_count
              FROM completed_per_year
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_concluidos_por_ano
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties:
                - originalName: cumulative_msr_count
                  renameTo: null
                  size: 177
                  wrapText: null
                  displayFormat: null
                - originalName: msr_per_year
                  renameTo: null
                  size: 128
                  wrapText: null
                  displayFormat: null
                - originalName: year
                  renameTo: null
                  size: 214
                  wrapText: null
                  displayFormat: null
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: 001c8456-6f75-41c0-97c3-cffa836dee7a
          cellLabel: por ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: 6ff97472-39e7-4f44-9895-6aa30914ccd6
                  xAxis:
                    type: datetime
                    style:
                      max: 1735700400000
                      min: 1514772000000
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: ano
                    timeUnit: year
                    dataFrameColumn: year
                  series:
                    - id: 80616841-4fb3-4d01-8525-df2bab0f19a6
                      type: bar
                      axis:
                        type: number
                        style:
                          max: 150
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "      "
                        aggregate: sum
                      dataFrameColumns:
                        - completed_per_year
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#2f4b7c"
                      opacity:
                        type: static
                        value: 0.7
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: outside-end
                      barWidth: 1
                      orientation: vertical
                      layout: grouped
                  dataFrame: atendimentos_concluidos_por_ano
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_12
            outputResult: false
            displayTableConfig: null
  - cellType: BLOCK
    cellId: 6a24c619-0bd5-4ffd-8ab9-5287b182c2a7 # DO NOT CHANGE - Hex uses this to match up cells when reimporting the file, and detect any changes to existing cells
    cellLabel: null
    config:
      blockConfig:
        sqlCellId: 28b831c3-fa27-4b25-9bc9-e3b1c89ac3f8
        chartCellId: a5d03e48-1074-472e-bf92-8304130c0dec
        activeTab: chart
      cells:
        - cellType: SQL
          cellId: 28b831c3-fa27-4b25-9bc9-e3b1c89ac3f8
          cellLabel: por mês no último ano
          config:
            source: |-
              WITH completed_per_month AS (
                  SELECT
                      DATE_TRUNC('month', created_at) AS month,
                      COUNT(*) AS completed_per_month
                  FROM match.matches
                  WHERE 
                      created_at >= CURRENT_DATE - INTERVAL '1 YEAR'
                      AND status = 'completed'
                  GROUP BY 1
              )
              SELECT *
              FROM completed_per_month
            dataFrameCell: false
            dataConnectionId: 683fd824-f935-4980-b99d-a7a513df5030
            resultVariableName: atendimentos_concluidos_por_mes
            useRichDisplay: true
            sqlCellOutputType: PANDAS
            useQueryMode: false
            castDecimals: true
            useNativeDates: true
            outputFilteredResult: true
            allowDuplicateColumns: false
            tableDisplayConfig:
              pageSize: 50
              height: null
              hideIcons: false
              hideIndex: false
              defaultSortColumn: null
              defaultSortIndexColumn: null
              defaultSortDirection: ASC
              conditionalFormatting: null
              filters: null
              columnProperties: []
              columnOrdering: null
              pinnedColumns: null
              hiddenColumns: null
        - cellType: CHARTV2
          cellId: a5d03e48-1074-472e-bf92-8304130c0dec
          cellLabel: por mês no último ano
          config:
            height: null
            chartSpec:
              type: layered
              layers:
                - id: f4161324-1f31-49c8-a1ad-0f1a04b9b6ad
                  xAxis:
                    type: datetime
                    style:
                      grid:
                        style: dash
                      ticks: {}
                      labels: {}
                    title: mês
                    dataFrameColumn: month
                  series:
                    - id: 306c0ab5-ab54-42b8-a955-cd9d00e1d985
                      type: line
                      axis:
                        type: number
                        style:
                          max: 12
                          grid:
                            style: dash
                          ticks:
                            count: 5
                          labels: {}
                        title: "          "
                        aggregate: sum
                      dataFrameColumns:
                        - completed_per_month
                      colorOrder: ascending
                      color:
                        type: static
                        color: "#2f4b7c"
                      opacity:
                        type: static
                        value: 0.9
                      tooltip:
                        type: auto
                      dataLabels:
                        fontSize: 10
                        position: above
                      point: true
                      stroke: solid
                      width: 3
                  dataFrame: atendimentos_concluidos_por_mes
              settings:
                legend:
                  position: right
                tooltip: true
                selectionEnabled: false
            chartSelection: {}
            colorMappings: {}
            resultVariable: filter_result_13
            outputResult: false
            displayTableConfig: null
appLayout:
  visibleMetadataFields:
    - NAME
    - DESCRIPTION
    - AUTHOR
    - LAST_EDITED
    - LAST_RUN
    - CATEGORIES
    - STATUS
    - TABLE_OF_CONTENTS
  fullWidth: false
  tabs:
    - name: Tab 1
      rows:
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a321b720-6994-440d-8a99-8284253733b5
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 40
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 0d81bcd1-5686-49c3-bea5-56215e32c5c5
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 40
              end: 80
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 8e562d19-a572-4175-ae6b-9c2cd8665ddf
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 80
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: aa413244-21e7-4eee-bd3e-15c02671c263
                  sharedFilterId: null
                  height: 350
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c002bb69-1b10-47d1-b372-a3b49ef81ba5
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: afedb86f-ee9b-4cda-8d20-82000ca4f84a
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 40
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: bd1e7eb7-53d6-4a21-a675-c618354b8000
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 40
              end: 80
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 838856fc-81e0-4c56-bd35-543b18e2a722
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 80
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 015535df-0080-49e2-b500-c495c5850131
                  sharedFilterId: null
                  height: 350
                  showLabel: true
        - columns:
            - start: 0
              end: 60
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 447de4f4-a368-4494-a61c-2745bdaaf06a
                  sharedFilterId: null
                  height: null
                  showLabel: false
            - start: 90
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 1c55bd0e-de54-4cb9-845e-4b5a78992a2e
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 30
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: e2b99b3d-df80-4357-8e7b-b82ab776b72e
                  sharedFilterId: null
                  height: 550
                  showLabel: true
            - start: 30
              end: 65
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 333a89b1-3bd7-4a43-8bb2-d17184ba98f7
                  sharedFilterId: null
                  height: 150
                  showLabel: true
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 7810c2a3-04b0-4b7f-8cba-567a6b95d632
                  sharedFilterId: null
                  height: 400
                  showLabel: true
            - start: 65
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 74c2d5b1-55cc-4007-a1d3-93a3414fdb4f
                  sharedFilterId: null
                  height: null
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 7c1b7718-9b01-4b87-a088-7af3bfae766f
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 35
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a0bb2f7e-6dff-499e-9a9e-42f927296b23
                  sharedFilterId: null
                  height: 450
                  showLabel: true
            - start: 35
              end: 75
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 03efd6de-4a86-4e29-94b6-79dc5c5562ae
                  sharedFilterId: null
                  height: 450
                  showLabel: true
            - start: 75
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: b1cc65dc-3410-4d2c-88eb-a6016297ad9e
                  sharedFilterId: null
                  height: 450
                  showLabel: true
        - columns:
            - start: 0
              end: 60
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 3026fdd4-ece5-438f-befd-9b4521141d02
                  sharedFilterId: null
                  height: null
                  showLabel: true
            - start: 90
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a915a006-1d0e-42f6-9552-6aee3a5f9b23
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 60
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: feb9f58f-eae4-4b0d-b28f-f0105c834130
                  sharedFilterId: null
                  height: 650
                  showLabel: true
            - start: 60
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: a48f2b64-e024-4669-a4df-2e7d393ef9b2
                  sharedFilterId: null
                  height: 300
                  showLabel: true
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 033cb758-847e-4b03-b444-df27bdc16c7b
                  sharedFilterId: null
                  height: 350
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: d7931a8e-450e-45a2-a775-4a29bfee6a5d
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 15cf8346-acf8-4198-9033-67ac7e863268
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 40
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: ad110c7f-feb1-438a-867f-54a74489116c
                  sharedFilterId: null
                  height: 400
                  showLabel: true
            - start: 40
              end: 80
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: d78b13e7-d70f-494e-8bdd-73e95f6f9deb
                  sharedFilterId: null
                  height: 400
                  showLabel: true
            - start: 80
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c5755ce5-d9ca-4537-a922-9a9298a5c49a
                  sharedFilterId: null
                  height: 400
                  showLabel: true
        - columns:
            - start: 0
              end: 20
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 76ed1a7e-4871-411b-adf4-1e1f9d5a2db5
                  sharedFilterId: null
                  height: 20
                  showLabel: false
            - start: 90
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 9c0f378c-4506-441a-9260-281715116532
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 25
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: af8a806b-ece4-4f14-8475-868327899a5c
                  sharedFilterId: null
                  height: 500
                  showLabel: true
            - start: 25
              end: 50
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: cb36e99f-eccc-4087-b583-8fbfa2230d8c
                  sharedFilterId: null
                  height: 500
                  showLabel: false
            - start: 50
              end: 85
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 95611aa9-f668-4c91-be28-2593a0c275eb
                  sharedFilterId: null
                  height: 200
                  showLabel: true
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: f51126e1-9a1b-4cab-b393-8a27082cbf59
                  sharedFilterId: null
                  height: 300
                  showLabel: true
            - start: 85
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 5fbf364b-8b56-4ec5-a262-7228fb8bef88
                  sharedFilterId: null
                  height: 200
                  showLabel: true
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 85162751-d5fb-4e48-b9f2-1fd4aab3a365
                  sharedFilterId: null
                  height: 300
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: af23a142-2a9c-45fe-90a9-1af961cf95a5
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 40
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: c07a5494-cc50-46bf-ad56-da980f301ee7
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 40
              end: 80
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: fd12f7b3-3132-41cd-9552-cbd233fc20ba
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 80
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 39ec01e8-adf8-4a01-a5e2-c0352fc56c58
                  sharedFilterId: null
                  height: 350
                  showLabel: true
        - columns:
            - start: 0
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 9b66307c-bf54-4b4e-bd45-68e09a879047
                  sharedFilterId: null
                  height: null
                  showLabel: false
        - columns:
            - start: 0
              end: 40
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 73c21702-8482-46e7-bbd4-06f7678d63e1
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 40
              end: 80
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 39e81d7f-82ed-4ce8-9ac7-9d9bd2ecc7ee
                  sharedFilterId: null
                  height: 350
                  showLabel: true
            - start: 80
              end: 120
              elements:
                - showSource: false
                  hideOutput: false
                  type: CELL
                  cellId: 28b831c3-fa27-4b25-9bc9-e3b1c89ac3f8
                  sharedFilterId: null
                  height: 350
                  showLabel: true
sharedFilters: []
